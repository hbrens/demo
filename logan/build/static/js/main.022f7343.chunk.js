(this["webpackJsonplogan-site-static-opensource"]=this["webpackJsonplogan-site-static-opensource"]||[]).push([[0],{235:function(e,t,n){e.exports=n.p+"static/media/new_logan_logo_white.6ea001ee.png"},240:function(e,t,n){e.exports=n(498)},250:function(e,t,n){},251:function(e,t,n){},38:function(e,t,n){e.exports={"inifinite-scroll-container":"style_inifinite-scroll-container__1NIvN","container-inner":"style_container-inner__2JpS2","log-search-arrow":"style_log-search-arrow__1fE6Z","log-type":"style_log-type__2avzd","log-time":"style_log-time__1wZHZ","log-tag":"style_log-tag__1RzRe","log-id":"style_log-id__1blPo","log-time-title-right":"style_log-time-title-right__2s56u","log-time-title-left":"style_log-time-title-left__1Lt0b","log-abbr":"style_log-abbr__39om2","detail-button":"style_detail-button__2OmhM","log-time-title":"style_log-time-title__1EA_t","log-content":"style_log-content__WthWr","timeline-item":"style_timeline-item__1tOSk","scroll-content":"style_scroll-content__1ESK3"}},421:function(e,t){},449:function(e,t,n){},454:function(e,t,n){},455:function(e,t,n){},495:function(e,t,n){},496:function(e,t,n){},497:function(e,t,n){},498:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(10),s=n.n(o),l=n(31),r=n(114),c=n(121),d=n(500),p=n(97),h=n(220),m=n(161),u=n(47),g=n(222),T=n(3),f=n(5),E=n.n(f);const I={filterConditions:{deviceId:"",platform:0,beginTime:E()().startOf("day").subtract(7,"days"),endTime:E()().startOf("day")},tasks:[],loading:!1};var y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NATIVE_UPDATE_TASKS":return Object(T.a)(Object(T.a)({},e),{},{tasks:t.tasks});case"NATIVE_UPDATE_FILTER_CONDITIONS":return Object(T.a)(Object(T.a)({},e),{},{filterConditions:t.filterConditions});case"NATIVE_CHANGE_LOADING":return Object(T.a)(Object(T.a)({},e),{},{loading:t.loading});default:return e}};const b={logInfo:null,logDownloadUrl:"",logTypes:[],logTypesInTask:[],briefs:[],taskDetails:[],logDetail:null,focusLogId:-1,highlightStartIndex:-1,highlightEndIndex:-1,filterConditions:{keyword:"",logTypes:[]},sorted:!0};var _=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NATIVE_UPDATE_LOG_INFO":return Object(T.a)(Object(T.a)({},e),{},{logInfo:t.logInfo});case"NATIVE_UPDATE_LOG_DOWNLOAD_URL":return Object(T.a)(Object(T.a)({},e),{},{logDownloadUrl:t.logDownloadUrl});case"NATIVE_UPDATE_LOG_TYPES":return Object(T.a)(Object(T.a)({},e),{},{logTypes:t.logTypes});case"NATIVE_UPDATE_BRIEFS":return Object(T.a)(Object(T.a)({},e),{},{briefs:t.briefs});case"NATIVE_UPDATE_TASK_DETAIL":if("up"===t.direction){let n=t.taskDetails.concat(e.taskDetails),a=n;return n.length>150&&(a=n.slice(0,150)),Object(T.a)(Object(T.a)({},e),{},{taskDetails:a})}if("down"===t.direction){let n=e.taskDetails.concat(t.taskDetails),a=n;return n.length>150&&(a=n.slice(n.length-150,n.length)),Object(T.a)(Object(T.a)({},e),{},{taskDetails:a})}return Object(T.a)(Object(T.a)({},e),{},{taskDetails:t.taskDetails});case"NATIVE_UPDATE_LOG_DETAIL":return Object(T.a)(Object(T.a)({},e),{},{logDetail:t.logDetail});case"NATIVE_UPDATE_HIGH_LIGHT_INDEX":return Object(T.a)(Object(T.a)({},e),{},{highlightStartIndex:t.highlightStartIndex,highlightEndIndex:t.highlightEndIndex});case"NATIVE_UPDATE_FOCUS_LOG_ID":return Object(T.a)(Object(T.a)({},e),{},{focusLogId:t.focusLogId});case"NATIVE_UPDATE_LOGDETAIL_FILTER_CONDITIONS":return Object(T.a)(Object(T.a)({},e),{},{filterConditions:t.filterConditions});case"NATIVE_UPDATE_LOG_TYPES_IN_TASK":return Object(T.a)(Object(T.a)({},e),{},{logTypesInTask:t.logTypesInTask});case"NATIVE_INITIAL_STATE":return Object(T.a)({},b);case"NATIVE_UPDATE_SORTED":return Object(T.a)(Object(T.a)({},e),{},{sorted:t.sorted});default:return e}};const D={filterConditions:{deviceId:"",beginTime:E()().startOf("day"),endTime:E()().startOf("day")},tasks:[],loading:!1};var v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"WEB_UPDATE_TASKS":return Object(T.a)(Object(T.a)({},e),{},{tasks:t.tasks});case"WEB_UPDATE_FILTER_CONDITIONS":return Object(T.a)(Object(T.a)({},e),{},{filterConditions:t.filterConditions});case"WEB_CHANGE_LOADING":return Object(T.a)(Object(T.a)({},e),{},{loading:t.loading});default:return e}};const O={logInfo:null,logTypesInTask:[],briefs:[],taskDetails:[],logDetail:null,highlightStartIndex:-1,highlightEndIndex:-1,focusLogId:-1,filterConditions:{keyword:"",logTypes:[]},sorted:!0};var L=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"WEB_UPDATE_LOG_INFO":return Object(T.a)(Object(T.a)({},e),{},{logInfo:t.logInfo});case"WEB_UPDATE_BRIEFS":return Object(T.a)(Object(T.a)({},e),{},{briefs:t.briefs});case"WEB_UPDATE_TASK_DETAIL":if("up"===t.direction){let n=t.taskDetails.concat(e.taskDetails),a=n;return n.length>150&&(a=n.slice(0,150)),Object(T.a)(Object(T.a)({},e),{},{taskDetails:a})}if("down"===t.direction){let n=e.taskDetails.concat(t.taskDetails),a=n;return n.length>150&&(a=n.slice(n.length-150,n.length)),Object(T.a)(Object(T.a)({},e),{},{taskDetails:a})}return Object(T.a)(Object(T.a)({},e),{},{taskDetails:t.taskDetails});case"WEB_UPDATE_LOG_DETAIL":return Object(T.a)(Object(T.a)({},e),{},{logDetail:t.logDetail});case"WEB_UPDATE_HIGH_LIGHT_INDEX":return Object(T.a)(Object(T.a)({},e),{},{highlightStartIndex:t.highlightStartIndex,highlightEndIndex:t.highlightEndIndex});case"WEB_UPDATE_FOCUS_LOG_ID":return Object(T.a)(Object(T.a)({},e),{},{focusLogId:t.focusLogId});case"WEB_UPDATE_LOGDETAIL_FILTER_CONDITIONS":return Object(T.a)(Object(T.a)({},e),{},{filterConditions:t.filterConditions});case"WEB_UPDATE_LOG_TYPES_IN_TASK":return Object(T.a)(Object(T.a)({},e),{},{logTypesInTask:t.logTypesInTask});case"WEB_INITIAL_STATE":return Object(T.a)({},O);case"WEB_UPDATE_SORTED":return Object(T.a)(Object(T.a)({},e),{},{sorted:t.sorted});default:return e}};const C=Object(h.composeWithDevTools)({}),k=Object(u.a)();var w,A=Object(p.createStore)((w=k,Object(p.combineReducers)({router:Object(c.b)(w),nativeList:y,nativeLogDetail:_,webList:v,webLogDetail:L})),C(Object(p.applyMiddleware)(Object(m.a)(k),g.a))),N=n(15),j=n(44),S=n(503),x=n(11),P=n(67),M=(n(61),n(250),n(96)),U=n(502),H=n(507),B=n(505),W=(n(251),n(223)),F=n.n(W);let V=Date.now();class G extends a.Component{constructor(){super(...arguments),this.state={clipboard:null}}render(){const{buttonId:e,shareUrl:t,buttonStyle:n,icon:a,buttonText:o}=this.props;return i.a.createElement(P.a,{id:e,"data-clipboard-text":t,style:n||{color:"#fff",backgroundColor:"#52c41a"}},!1===a?"":i.a.createElement(x.a,{type:"share-alt"}),o)}componentDidMount(){const e=new F.a("#"+this.props.buttonId);e.on("success",()=>{Date.now()-V>1e3&&(H.a.success("\u94fe\u63a5\u5df2\u590d\u5236\u5230\u526a\u8d34\u677f",2),V=Date.now())}),this.setState(e)}componentWillUnmount(){this.state.clipboard&&this.state.clipboard.destroy()}}var Y=G;const{Option:K}=M.a,{RangePicker:R}=U.a,{Header:q}=d.a;class X extends a.Component{constructor(){super(...arguments),this.composeShareUrl=()=>{const{filterConditions:e,type:t,pathname:n}=this.props;return"native"===t?"".concat(window.location.origin,"/#").concat(n,"?deviceId=").concat(e.deviceId,"&beginTime=").concat(E()(e.beginTime).valueOf(),"&endTime=").concat(E()(e.endTime).valueOf(),"&platform=").concat(e.platform):"".concat(window.location.origin,"/#").concat(n,"?deviceId=").concat(e.deviceId,"&beginTime=").concat(E()(e.beginTime).valueOf(),"&endTime=").concat(E()(e.endTime).valueOf())},this.handleSearch=()=>{const{filterConditions:e,fetchTasks:t,type:n}=this.props;""!==e.deviceId?t("native"===n?{deviceId:e.deviceId,platform:e.platform,beginTime:E()(e.beginTime).valueOf(),endTime:E()(e.endTime).valueOf()}:{deviceId:e.deviceId,beginTime:E()(e.beginTime).valueOf(),endTime:E()(e.endTime).valueOf()}):H.a.error("\u5fc5\u987b\u586b\u5199\u8bbe\u5907\u7f16\u53f7\u624d\u80fd\u8fdb\u884c\u67e5\u8be2\uff01")},this.handleDeviceIdChange=e=>{const{filterConditions:t,updateFilterConditions:n}=this.props;n(Object(T.a)(Object(T.a)({},t),{},{deviceId:e.target.value}))},this.handleCleanDeviceId=()=>{const{filterConditions:e,updateFilterConditions:t}=this.props;t(Object(T.a)(Object(T.a)({},e),{},{deviceId:""}))},this.handlePlatformChange=e=>{const{filterConditions:t,updateFilterConditions:n}=this.props;n(Object(T.a)(Object(T.a)({},t),{},{platform:e}))},this.handleTimeRangeChange=e=>{const{filterConditions:t,updateFilterConditions:n}=this.props,[a,i]=e;i.diff(a)>=6048e5?H.a.warn("\u8bf7\u4fdd\u8bc1\u9009\u62e9\u7684\u65f6\u95f4\u8303\u56f4\u4e0d\u8d85\u8fc77\u5929"):n(Object(T.a)(Object(T.a)({},t),{},{beginTime:a.valueOf(),endTime:i.valueOf()}))}}render(){const{filterConditions:e,type:t}=this.props;return i.a.createElement(q,{className:"header"},i.a.createElement("div",{className:"tasklist-filterbar-container"},i.a.createElement(B.a.Group,{compact:!0,className:"filterbar-group"},"native"===t&&i.a.createElement(M.a,{"data-test":"platform-selector",value:e.platform,onChange:this.handlePlatformChange,style:{minWidth:"100px"}},i.a.createElement(K,{value:0},"\u5168\u90e8\u5e73\u53f0"),i.a.createElement(K,{value:1},"Android"),i.a.createElement(K,{value:2},"iOS")),i.a.createElement(R,{"data-test":"range-picker",allowClear:!1,format:"YYYY-MM-DD",placeholder:["\u8d77\u59cb\u65f6\u95f4","\u7ed3\u675f\u65f6\u95f4"],onChange:this.handleTimeRangeChange,value:[E()(e.beginTime),E()(e.endTime)],style:{minWidth:"240px"}}),i.a.createElement(B.a,{"data-test":"deviceId-input",className:"filter-input",placeholder:"\u8bbe\u5907\u7f16\u53f7",value:e.deviceId,onChange:this.handleDeviceIdChange,suffix:e.deviceId?i.a.createElement(x.a,{"data-test":"clean-deviceId-icon",className:"empty-search",key:"empty-search",type:"close-circle",onClick:this.handleCleanDeviceId}):i.a.createElement("span",null)})),i.a.createElement(P.a,{"data-test":"search-button",icon:"search",type:"primary",onClick:this.handleSearch},"\u641c\u7d22")),i.a.createElement(Y,{buttonId:"share-button",shareUrl:this.composeShareUrl(),buttonText:"\u5206\u4eab"}))}}X.defaultProps={filterConditions:{deviceId:"",platform:0,beginTime:E()().startOf("week"),endTime:E()().startOf("day")},updateFilterConditions:null,fetchTasks:null};var $=Object(l.c)((function(e){return{pathname:e.router.location.pathname,search:e.router.location.search,hash:e.router.location.hash}}))(X);const{Column:z}=S.a,Q={"-1":i.a.createElement("span",null,"Unknown"),0:i.a.createElement("span",null,i.a.createElement(x.a,{type:"android"})," | ",i.a.createElement(x.a,{type:"apple"})),1:i.a.createElement("span",null,i.a.createElement(x.a,{type:"android"})),2:i.a.createElement("span",null,i.a.createElement(x.a,{type:"apple"}))};class J extends a.Component{constructor(){super(...arguments),this.renderNativeColumns=(e,t)=>i.a.createElement(S.a,{size:"middle",dataSource:e,loading:t,pagination:!1,scroll:{y:650},rowKey:"taskId"},i.a.createElement(z,{title:"\u4efb\u52a1id",dataIndex:"taskId",key:"taskId",width:"10%"}),i.a.createElement(z,{title:"AppId",dataIndex:"appId",key:"appId",width:"10%"}),i.a.createElement(z,{title:"AppVersion",dataIndex:"appVersion",key:"appVersion",width:"10%"}),i.a.createElement(z,{title:"\u8bbe\u5907\u6807\u8bc6",dataIndex:"deviceId",key:"deviceId",width:"15%"}),i.a.createElement(z,{title:"unionId",dataIndex:"unionId",key:"unionId",width:"15%"}),i.a.createElement(z,{title:"\u8bbe\u5907\u5e73\u53f0",dataIndex:"platform",key:"platform",width:"10%",render:this.renderColumnPlatform}),i.a.createElement(z,{title:"\u65e5\u5fd7\u5f53\u5929\u65f6\u95f4",dataIndex:"logDate",key:"logDate",width:"10%",render:this.renderColumnLogDate}),i.a.createElement(z,{title:"\u65e5\u5fd7\u4e0a\u62a5\u65f6\u95f4",dataIndex:"addTime",key:"addTime",width:"10%",render:this.renderColumnAddTime}),i.a.createElement(z,{title:"\u64cd\u4f5c",dataIndex:"action",width:"10%",render:this.renderColumnAction})),this.renderWebColumns=(e,t)=>i.a.createElement(S.a,{size:"middle",dataSource:e,loading:t,pagination:!1,scroll:{y:650},rowKey:"taskId"},i.a.createElement(z,{title:"\u8bbe\u5907\u6807\u8bc6",dataIndex:"deviceId",key:"deviceId",width:"30%"}),i.a.createElement(z,{title:"\u65e5\u5fd7\u6765\u6e90",dataIndex:"webSource",key:"webSource",width:"15%",render:this.renderColumnWebSource}),i.a.createElement(z,{title:"\u73af\u5883\u4fe1\u606f",dataIndex:"environment",key:"environment",width:"15%",render:this.renderColumnEnvironment}),i.a.createElement(z,{title:"\u65e5\u5fd7\u5f53\u5929\u65f6\u95f4",dataIndex:"logDate",key:"logDate",width:"10%",render:this.renderColumnLogDate}),i.a.createElement(z,{title:"\u65e5\u5fd7\u4e0a\u62a5\u65f6\u95f4",dataIndex:"addTime",key:"addTime",width:"10%",render:this.renderColumnAddTime}),i.a.createElement(z,{title:"\u64cd\u4f5c",dataIndex:"action",width:"10%",render:this.renderColumnAction})),this.renderColumnPlatform=e=>Q[e],this.renderColumnWebSource=e=>null===e?i.a.createElement("span",null,"-"):i.a.createElement("span",null,e),this.renderColumnEnvironment=e=>null===e?i.a.createElement("span",null,"-"):i.a.createElement("span",null,e),this.renderColumnLogDate=e=>i.a.createElement("div",null,E()(e).format("YYYY-MM-DD")),this.renderColumnAddTime=e=>i.a.createElement("div",null,E()(e).format("YYYY-MM-DD HH:mm:ss.SSS")),this.renderColumnAction=(e,t,n)=>{const{type:a}=this.props;return"native"===a?i.a.createElement(P.a,{onClick:this.toDetail(t.taskId)},"\u65e5\u5fd7\u8be6\u60c5"):i.a.createElement(P.a,{onClick:this.toDetail(t.tasks)},"\u65e5\u5fd7\u8be6\u60c5")},this.toDetail=e=>()=>{const{detailUrlPrefix:t}=this.props;this.props.history.push("".concat(t,"?tasks=").concat(e))}}render(){const{filterConditions:e,tasks:t,updateFilterConditions:n,fetchTasks:a,loading:o,type:s}=this.props;return i.a.createElement("div",{className:"listpage-container"},i.a.createElement($,{filterConditions:e,updateFilterConditions:n,fetchTasks:a,type:s}),i.a.createElement("div",{className:"table-container"},(()=>"native"===s?this.renderNativeColumns(t,o):"web"===s?this.renderWebColumns(t,o):void 0)()))}}var Z=J,ee=n(158),te=n.n(ee);let ne=[];const ae=te.a.create({baseURL:"/logan-web/api",timeout:3e4,withCredentials:!0});function ie(e){return ae.get("/logan/task/".concat(e,"/info.json"))}function oe(e,t,n){return ae.get("/logan/task/".concat(e,"/brief.json"),{params:{logTypes:t,keyword:n}})}function se(e){return ae.get("/logan/task/query/details.json",{params:{detailIds:e}})}function le(e){return ae.get("/logan/task/".concat(e,"/detail.json"))}function re(e){return ae.get("/logan/task/".concat(e,"/download.json"))}function ce(e,t,n){return ae.get("/logan/web/detailIndex.json",{params:{tasks:e,logTypes:t,keyword:n,beginTime:null,endTime:null}})}function de(e){return ae.get("/logan/web/details.json",{params:{detailIds:e}})}function pe(e){return ae.get("/logan/web/taskDetail.json",{params:{tasks:e}})}function he(e){return ae.get("/logan/web/logDetail.json",{params:{detailId:e}})}const me=e=>{ne.forEach((t,n)=>{t.id===e.url+"&"+e.method&&(t.cancel(),ne.splice(n,1))})};function ue(){return e=>ae.get("/logan/latest.json").then(t=>{e({type:"NATIVE_UPDATE_TASKS",tasks:t})})}function ge(e){let{deviceId:t,platform:n,beginTime:a,endTime:i}=e;return(e,o)=>function(e,t,n,a){return console.log({deviceId:e,platform:t,beginTime:n,endTime:a}),ae.get("/logan/task/search.json",{params:{deviceId:e,platform:t,beginTime:n,endTime:a}})}(t,n,a,i).then(t=>{e({type:"NATIVE_UPDATE_TASKS",tasks:t})})}ae.interceptors.request.use(e=>(e.headers.cancelOthers&&(delete e.headers.cancelOthers,me(e),e.cancelToken=(e=>new te.a.CancelToken(t=>{ne.push({id:e.url+"&"+e.method,cancel:t})}))(e)),e.headers.removeXRequestedWith&&(delete e.headers.removeXRequestedWith,delete e.headers["X-Requested-With"]),e)),ae.interceptors.response.use((function(e){me(e.config);let{code:t,msg:n,data:a}=e.data;return 200!==Number(t)?(H.a.warning("\u8bf7\u6c42\u51fa\u9519\uff1a".concat(n)),Promise.reject(e.data)):a}),(function(e){if(!e.request)return null;let t=e.response&&e.response.status;return H.a.error("\u8bf7\u6c42\u51fa\u9519".concat(t||e.message)),Promise.reject(e)}));class Te extends a.Component{componentDidCatch(e,t){H.a.error("\u9875\u9762\u5f02\u5e38\uff01"),this.props.history.replace("/")}componentDidMount(){const{updateFilterConditions:e,fetchTasks:t,fetchInitData:n}=this.props;let a={};this.props.location&&(a=Object(j.parse)(this.props.location.search,{ignoreQueryPrefix:!0}));const{deviceId:i,platform:o,beginTime:s,endTime:l}=a;Object(N.some)([i,s,l,o],e=>void 0===e)&&!Object(N.every)([i,s,l,o],e=>void 0===e)&&H.a.warn("url\u53c2\u6570\u9519\u8bef\uff01\u83b7\u53d6\u9ed8\u8ba4\u65e5\u5fd7\u5217\u8868"),e({deviceId:void 0!==i?i:"",platform:void 0!==o?Number.parseInt(o):0,beginTime:void 0!==s?E()(Number.parseInt(s)).valueOf():E()().startOf("day").subtract(6,"days").valueOf(),endTime:void 0!==l?E()(Number.parseInt(l)).valueOf():E()().startOf("day").valueOf()}),i&&s&&l&&o?t({deviceId:i,platform:o,beginTime:E()(Number.parseInt(s)).valueOf(),endTime:E()(Number.parseInt(l)).valueOf()}):n()}render(){return i.a.createElement(Z,Object.assign({},this.props,{"data-test":"ListPage",type:"native",detailUrlPrefix:"/native-log-detail"}))}}var fe=Object(l.c)((function(e){return Object(T.a)({},e.nativeList)}),(function(e){return{updateFilterConditions:t=>e(function(e){return(t,n)=>{t({type:"NATIVE_UPDATE_FILTER_CONDITIONS",filterConditions:e})}}(t)),fetchTasks:t=>e(ge(t)),fetchInitData:()=>e(ue())}}))(Te);function Ee(e,t){const n=Object(N.findIndex)(e,e=>e.id===t),a=Math.ceil(e.length/25),i=Math.floor(n/25);return a<=3?e.map(e=>e.id):0===i?e.slice(0,75).map(e=>e.id):i===a-1?e.slice(25*(a-3),25*a).map(e=>e.id):e.slice(25*(i-1),25*(i+2)).map(e=>e.id)}const Ie=[{logType:1,logTypeName:"exception catch \u65e5\u5fd7",displayColor:"#32CD32"},{logType:2,logTypeName:"custom \u4ee3\u7801\u65e5\u5fd7",displayColor:"#2f54eb"},{logType:3,logTypeName:"network\u65e5\u5fd7",displayColor:"#5c3317"},{logType:84,logTypeName:"\u6027\u80fd\u65e5\u5fd7",displayColor:"#5c3317"}],ye=[{logType:1,logTypeName:"\u65e5\u5fd7\u7c7b\u578b1",displayColor:"#32CD32"},{logType:2,logTypeName:"\u65e5\u5fd7\u7c7b\u578b2",displayColor:"#2f54eb"},{logType:3,logTypeName:"\u65e5\u5fd7\u7c7b\u578b3",displayColor:"#5c3317"}],be=(e,t)=>{let n=[];const a="native"===t?Ie:ye;for(let i of e){let e=a.find(e=>e.logType===i.logType);void 0===e&&(e={logType:0,logTypeName:"\u672a\u77e5\u65e5\u5fd7",displayColor:"#000000"}),"native"===t?n.push({id:i.id,time:i.logTime,logType:{type:e.logType,logTypeName:e.logTypeName,displayColor:e.displayColor}}):n.push({id:i.detailId,time:i.logTime,logType:{type:e.logType,logTypeName:e.logTypeName,displayColor:e.displayColor}})}return n},_e=(e,t)=>"native"===t?e:e.map(e=>({id:e.detailId,logTime:e.logTime,logType:e.logType}));var De=n(123),ve=n(82),Oe=n(84),Le=n(43),Ce=n(501),ke=n(122);n(449);const we=De.a.Group;class Ae extends a.Component{constructor(){super(...arguments),this.state={logTypeDropdownVisible:!1,sortedDropdownVisible:!1,keywordTemp:""},this.handleLogTypesChanged=e=>{const{filterConditions:t,onFilterConditionChanged:n,logTypesInTask:a}=this.props,i=t.logTypes;let o=[];o=e.includes("all")?i.length===a.length?e.filter(e=>"all"!==e):a:i.length===a.length?[]:e,n(Object(T.a)(Object(T.a)({},t),{},{logTypes:o}))},this.handleSortedChange=e=>{const{onSortedChanged:t,rollingListManually:n}=this.props;this.setState({sortedDropdownVisible:!1}),t(e.target.value),n(0)},this.handleKeywordClear=()=>{const{filterConditions:e,onFilterConditionChanged:t}=this.props;t(Object(T.a)(Object(T.a)({},e),{},{keyword:""})),this.setState({keywordTemp:"",searchCursor:null})},this.handleKeywordTempChange=e=>{this.setState({keywordTemp:e.target.value})},this.handleKeywordSearchConfirm=()=>{const{filterConditions:e,onFilterConditionChanged:t}=this.props;t(Object(T.a)(Object(T.a)({},e),{},{keyword:this.state.keywordTemp}))}}render(){const{filterConditions:e,logTypesInTask:t,type:n,sorted:a}=this.props,o="native"===n?Ie:ye,s=i.a.createElement("div",null,i.a.createElement(ve.a.Group,{onChange:this.handleLogTypesChanged,className:"log-type-checkbox",value:e.logTypes.length===t.length?["all",...e.logTypes]:e.logTypes,selectable:"true"},i.a.createElement(Oe.a,null,i.a.createElement(Le.a,null,i.a.createElement(ve.a,{value:"all"},"\u5168\u9009"))),i.a.createElement(Ce.a,{style:{margin:"8px 0 5px"}}),t.map(e=>{const t=o.find(t=>t.logType===e);return void 0===t?i.a.createElement(Oe.a,{key:e,className:"log-type-checkitem"},i.a.createElement(Le.a,null,i.a.createElement(ve.a,{value:e},i.a.createElement("div",{className:"check-item-wrapper"},i.a.createElement("span",{style:{color:"#000000"}},"\u672a\u77e5\u7c7b\u578b"))))):i.a.createElement(Oe.a,{key:t.logType,className:"log-type-checkitem"},i.a.createElement(Le.a,null,i.a.createElement(ve.a,{value:t.logType},i.a.createElement("div",{className:"check-item-wrapper"},i.a.createElement("span",{style:{color:t.displayColor}},t.logTypeName)))))}))),l=i.a.createElement(we,{className:"reverse-type",onChange:this.handleSortedChange,value:a},i.a.createElement(De.a,{value:!0,name:"\u5347\u5e8f",className:"reverse-type-item",key:"true"},"\u5347\u5e8f",i.a.createElement(x.a,{type:"arrow-up",className:"reverse-arrow"})),i.a.createElement(De.a,{value:!1,name:"\u964d\u5e8f",className:"reverse-type-item",key:"false"},"\u964d\u5e8f",i.a.createElement(x.a,{type:"arrow-down",className:"reverse-arrow"})));return i.a.createElement("div",{className:"filterbar-container"},i.a.createElement(ke.a,{overlay:s,trigger:["click"],visible:this.state.logTypeDropdownVisible,onVisibleChange:e=>{this.setState({logTypeDropdownVisible:e})}},i.a.createElement(P.a,{className:"filter-log-type"},i.a.createElement(x.a,{type:"check-square"}),"\u65e5\u5fd7\u7c7b\u578b")),i.a.createElement(ke.a,{overlay:l,trigger:["click"],visible:this.state.sortedDropdownVisible,onVisibleChange:e=>{this.setState({sortedDropdownVisible:e})}},i.a.createElement(P.a,{className:"filter-log-type"},i.a.createElement(x.a,{type:"check-circle"}),!1===e.sorted?"\u6392\u5e8f\u65b9\u5f0f\uff1a\u964d\u5e8f":"\u6392\u5e8f\u65b9\u5f0f\uff1a\u5347\u5e8f")),i.a.createElement("div",{className:"filter-keyword-search-wrapper"},i.a.createElement(B.a,{style:{flex:1},className:"filter-keyword-search",placeholder:"\u67e5\u627e\u65e5\u5fd7\u5173\u952e\u5b57\uff0c\u56de\u8f66\u63d0\u4ea4",prefix:this.state.keywordTemp?i.a.createElement(x.a,{type:"close-circle-o",style:{color:"rgba(0,0,0,.25)",cursor:"pointer"},onClick:this.handleKeywordClear}):i.a.createElement("span",null),suffix:this.state.keywordTemp?i.a.createElement(x.a,{type:"search",style:{color:"rgba(0,0,0,.45)",cursor:"pointer"},onClick:this.handleKeywordSearchConfirm}):i.a.createElement("span",null),value:this.state.keywordTemp,onChange:this.handleKeywordTempChange,onPressEnter:this.handleKeywordSearchConfirm})))}}var Ne=Ae,je=n(504);n(454);const Se={id:"\u65e5\u5fd7\u7f16\u53f7",taskId:"\u4efb\u52a1\u7f16\u53f7",logType:"\u65e5\u5fd7\u7c7b\u578b",logTime:"\u65e5\u5fd7\u8bb0\u5f55\u65f6\u95f4"};class xe extends a.Component{constructor(){super(...arguments),this.handleCloseButtonClicked=()=>{this.props.updateFocusLogId(-1)},this.conposeSnippetComponents=()=>{const{logDetail:e,type:t}=this.props,n="native"===t?Ie:ye;if(null!==e){return{cardTitle:i.a.createElement("header",null,i.a.createElement("h1",null,"\u65e5\u5fd7\u6761\u76ee\u8be6\u60c5")),closeButton:i.a.createElement(P.a,{icon:"close",shape:"circle",size:"small",onClick:this.handleCloseButtonClicked}),metaDatas:Object.keys(e).map(t=>{if(!Object.keys(Se).includes(t))return null;let a="";if("logType"===t){const i=n.find(n=>n.logType===e[t]);a=void 0===i?"\u672a\u77e5\u65e5\u5fd7":i.logTypeName}else a="logTime"===t?E()(e[t]).format("YYYY-MM-DD HH:mm:ss.SSS"):e[t];return i.a.createElement("div",{className:"metadata-item",key:Se[t]},Se[t]," : ",a)})}}return{cardTitle:null,closeButton:null,metaDatas:null}}}render(){const{focusLogId:e,logDetail:t}=this.props;if(-1===e)return null;{const{cardTitle:e,closeButton:n,metaDatas:a}=this.conposeSnippetComponents();return i.a.createElement(je.a,{className:"detail-information-container",title:e,extra:n},i.a.createElement("div",{className:"metadata"},a),t&&i.a.createElement("div",{className:"log-content"},"\u65e5\u5fd7\u4fe1\u606f:",i.a.createElement("br",null),t.content))}}}var Pe=xe,Me=n(506),Ue=n(233),He=n.n(Ue);n(455);const{Panel:Be}=Me.a;class We extends a.Component{render(){const{logInfo:e,type:t}=this.props;if("native"===t){const t=i.a.createElement("span",null,i.a.createElement("span",{style:{maxWidth:"120px",textOverflow:"ellipsis",margin:"20px 0"}},"\u3010",e&&e.unionId,"\u3011"),i.a.createElement("span",null,"\u65e5\u5fd7\u57fa\u672c\u4fe1\u606f"));return i.a.createElement(Me.a,{bordered:!1,accordion:!0,className:"log-report-detail"},i.a.createElement(Be,{header:t,key:"1"},i.a.createElement("p",null,"\u4efb\u52a1ID\uff1a",e&&e.taskId),i.a.createElement("p",null,"AppId: ",e&&e.appId),i.a.createElement("p",null,"AppVersion: ",e&&e.appVersion),i.a.createElement("p",null,"UnionId: ",e&&e.unionId),i.a.createElement("p",null,"\u8bbe\u5907\u5e73\u53f0\uff1a",e&&this.platformNameByPlatformId.get(e.platform)),i.a.createElement("p",null,"\u8bbe\u5907\u6807\u8bc6\uff1a",e&&e.deviceId),i.a.createElement("p",null,"\u65e5\u5fd7\u65f6\u95f4\uff1a",e&&E()(e.logDate).format("YYYY-MM-DD")),i.a.createElement("p",null,"\u4e0a\u62a5\u65f6\u95f4\uff1a",e&&E()(e.addTime).format("YYYY-MM-DD HH:mm:ss.SSS")),i.a.createElement("p",null,"\u65e5\u5fd7\u5927\u5c0f\uff1a",e&&He()(Number.parseInt(e.amount)).format("0.00 b"))))}{const t=i.a.createElement("span",null,i.a.createElement("span",{style:{maxWidth:"120px",textOverflow:"ellipsis",margin:"20px 0"}},"\u3010",e&&e.deviceId,"\u3011"),i.a.createElement("span",null,"\u65e5\u5fd7\u57fa\u672c\u4fe1\u606f"));return i.a.createElement(Me.a,{bordered:!1,accordion:!0,className:"log-report-detail"},i.a.createElement(Be,{header:t,key:"1"},i.a.createElement("p",null,"\u8bbe\u5907\u6807\u8bc6\uff1a",e&&e.deviceId),i.a.createElement("p",null,"\u6765\u6e90\uff1a",e&&e.webSource),i.a.createElement("p",null,"\u73af\u5883\u4fe1\u606f\uff1a",e&&e.environment),i.a.createElement("p",null,"\u65e5\u5fd7\u65f6\u95f4\uff1a",E()(e&&e.addTime).format("YYYY-MM-DD HH:mm:ss")),i.a.createElement("p",null,"\u65e5\u5fd7\u6240\u5c5e\u5929\uff1a",E()(e&&e.logDate).format("YYYY-MM-DD")),i.a.createElement("p",null,"\u81ea\u5b9a\u4e49\u4fe1\u606f\uff1a",e&&e.customReportInfo)))}}get platformNameByPlatformId(){const e=new Map;return e.set(-1,"Unknown"),e.set(0,i.a.createElement("span",null,i.a.createElement(x.a,{type:"apple"})," | ",i.a.createElement(x.a,{type:"android"}))),e.set(1,i.a.createElement("span",null,i.a.createElement(x.a,{type:"android"}))),e.set(2,i.a.createElement("span",null,i.a.createElement(x.a,{type:"apple"}))),e}}var Fe=We,Ve=n(508),Ge=n(231),Ye=n(234),Ke=n.n(Ye);var Re=n(38),qe=n.n(Re);class Xe extends a.Component{constructor(e){super(e),this.loadMore=(e,t)=>{const{briefs:n,data:a,rollingListManually:i,fetchTaskDetail:o}=this.props,{upHasMore:s,downHasMore:l}=this.state;let r;if(r="up"===e||this.state.mouseUpRolling,(r&&s||!r&&l)&&(r&&Date.now()-this.lastUploadTime>1500&&!this.state.uploading||!r&&Date.now()-this.lastDownloadTime>1500&&!this.state.downloading)){const e=25,t=Object(N.findIndex)(n,e=>e.id===a[0].id),s=Object(N.findIndex)(n,e=>e.id===a[a.length-1].id),l=Math.floor(t/e),c=Math.floor((s+1)/e);if(r){this.setState({uploading:!0}),this.lastUploadTime=Date.now();o(n.slice((l-1)*e,l*e).map(e=>e.id),"up").then(()=>{const e=this.getHeadAndBottomLogIdInView(a,n),t=a.findIndex(t=>t.id===e.startLogId);i(t),this.setState({uploading:!1})})}else{this.setState({downloading:!0}),this.lastDownloadTime=Date.now();const t=this.getHeadAndBottomLogIdInView(a,n);o(n.slice(c*e,(c+1)*e).map(e=>e.id),"down").then(()=>{const e=a.findIndex(e=>e.id===t.startLogId);i(e),this.setState({downloading:!1})})}}},this.updateHighLightIndex=()=>{const{data:e,briefs:t,updateHighLightIndex:n}=this.props;let a=this.getLogHeadAndBottomInView(e,t);n(a.startLogIndex,a.endLogIndex)},this.getLogHeadAndBottomInView=(e,t)=>{let n=document.querySelector("#infinite-container-inner").scrollTop,a=document.querySelector("#infinite-container-inner").clientHeight,i=Math.max(Math.round(n/56),0),o=Math.round(a/56);if(e.length>0&&t.length>0){let n=e[Math.min(i,e.length-1)].id,a=e[Math.min(i+o,e.length-1)].id;return{startLogIndex:t.findIndex(e=>e.id===n),endLogIndex:t.findIndex(e=>e.id===a)}}return{startLogIndex:-1,endLogIndex:-1}},this.getHeadAndBottomLogIdInView=(e,t)=>{let n=document.querySelector("#infinite-container-inner").scrollTop,a=document.querySelector("#infinite-container-inner").clientHeight,i=Math.max(parseInt(n/56),0),o=parseInt(a/56);if(e.length>0&&t.length>0){return{startLogId:e[Math.min(i,e.length-1)].id,endLogId:e[Math.min(i+o,e.length-1)].id}}return{startLogId:-1,endLogId:-1}},this.calculateIndexOfLogList=(e,t)=>t.findIndex(t=>t.id===e),this.passiveSupported=!1,this.lastUploadTime=Date.now(),this.lastDownloadTime=Date.now(),this.uploading=!1,this.downloading=!1,this.state={mouseUpRolling:!1,upHasMore:!1,downHasMore:!1};try{const e=Object.defineProperty({},"passive",{get(){return this.passiveSupported=!0,this.passive}});window.addEventListener("test",null,e)}catch(t){}}componentDidMount(){document.addEventListener("mousewheel",e=>{e.wheelDelta>0?this.state.mouseUpRolling||this.setState({mouseUpRolling:!0}):this.state.mouseUpRolling&&this.setState({mouseUpRolling:!1}),this.updateHighLightIndex()},!!this.passiveSupported&&{passive:!0}),this.updateHighLightIndex()}shouldComponentUpdate(e,t,n){return!Object(N.isEqual)(e,this.props)||!Object(N.isEqual)(t,this.state)}componentDidUpdate(e,t,n){const{data:a,briefs:i,focusLogId:o,rollingListManually:s}=this.props;if(0===a.length||0===i.length)return!1;const l=Math.ceil(i.length/25);if(e.focusLogId!==o&&-1!==o){s(this.calculateIndexOfLogList(o,a))}this.updateHighLightIndex(),t.upHasMore===this.state.upHasMore&&t.downHasMore===this.state.downHasMore&&(l<=3?this.setState({upHasMore:!1,downHasMore:!1}):(a[a.length-1].id===i[i.length-1].id?this.setState({downHasMore:!1}):this.setState({downHasMore:!0}),a[0].id===i[0].id?this.setState({upHasMore:!1}):this.setState({upHasMore:!0})))}render(){const{data:e,focusLogId:t,type:n,updateFocusLogId:a}=this.props,{upHasMore:o,downHasMore:s,mouseUpRolling:l}=this.state;return i.a.createElement("div",{className:qe.a["inifinite-scroll-container"]},i.a.createElement("div",{className:qe.a["container-inner"],id:"infinite-container-inner"},l&&!o&&i.a.createElement(Ce.a,{className:"bottom-line"},"\u9876\u90e8"),o&&i.a.createElement("div",{className:"log-uploading-top"},i.a.createElement("div",{className:"log-uploading-trigger",onClick:()=>{this.loadMore("up")}},i.a.createElement(x.a,{type:"caret-up"}))),i.a.createElement(Ke.a,{initialLoad:!1,pageStart:0,loadMore:()=>{this.loadMore()},hasMore:l&&o||!l&&s,useWindow:!1,isReverse:l,threshold:250,className:qe.a["scroll-content"]},i.a.createElement(Ve.a,{style:{marginTop:"20px"}},e.map((e,o)=>i.a.createElement(ze,{item:e,index:o,focusLogId:t,type:n,updateFocusLogId:a,key:"".concat(e.id,"-").concat(o)})))),this.state.downloading&&i.a.createElement("div",{className:"demo-loading"},i.a.createElement(Ge.a,null)),!s&&i.a.createElement(Ce.a,{className:"bottom-line"},"\u5230\u5e95\u4e86")))}}var $e=Xe;function ze(e){let{item:t,index:n,focusLogId:a,type:o,updateFocusLogId:s}=e;let l=("native"===o?Ie:ye).find(e=>e.logType===t.logType);return void 0===l&&(l={logType:0,logTypeName:"\u672a\u77e5\u65e5\u5fd7",displayColor:"#000000"}),i.a.createElement(Ve.a.Item,{className:qe.a["timeline-item"],id:"log-item-row-"+n,color:l.displayColor,key:"log-item-row-"+t.id,onClick:e=>{e.preventDefault(),e.stopPropagation(),s(t.id)}},i.a.createElement("div",{style:{backgroundColor:t.id===a?"#e6f7ff":"transparent"}},i.a.createElement("div",{className:qe.a["log-time-title"]},i.a.createElement("div",{className:qe.a["log-time-title-left"]},i.a.createElement("div",{className:qe.a["log-type"],style:{color:l.displayColor}},l.logTypeName,":"),i.a.createElement("div",{className:qe.a["log-time"]},E()(t.logTime).format("HH:mm:ss.SSS"))),i.a.createElement("div",{className:qe.a["log-time-title-right"]},i.a.createElement("div",{className:qe.a["log-id"]},"\u65e5\u5fd7ID\uff1a",t.id))),i.a.createElement("div",{className:qe.a["log-content"]},i.a.createElement("div",{className:qe.a["log-abbr"]},t.simpleContent||t.content))))}var Qe=n(53),Je=n.n(Qe);class Ze extends a.Component{constructor(e){super(e),this.onMouseMove=e=>{const{data:t}=this.props;if(this._isInTimeline(e.offsetX,e.offsetY)){const n=this._calculateLogIndexFromCoordinate(e.offsetX,e.offsetY-this.timelineMarginTop);null!==n&&"canvas"===e.target.localName&&this.setState({showToolTip:!0,toolTipX:this.$container.clientWidth+this.$container.offsetLeft,toolTipY:e.clientY,hoveredLog:t[n]}),this.hoverMark.y(e.offsetY),this.hoverMark.isVisible()||this.hoverMark.show()}else this.setState({showToolTip:!1}),this.hoverMark.isVisible()&&this.hoverMark.hide();"canvas"===e.target.localName&&this.stage.draw()},this.onClick=e=>{if(this._isInTimeline(e.offsetX,e.offsetY)&&"canvas"===e.target.localName){const{updateFocusLogId:e}=this.props;null!==this.state.hoveredLog&&e(this.state.hoveredLog.id)}},this._prepareContainer=()=>{this.$container=document.querySelector("#timeline-container"),this.clientHeight=this.$container.clientHeight,this.clientWidth=this.$container.clientWidth},this._prepareHoverMark=()=>{this.hoverMark=new Je.a.Line({points:[4,0,this.timelineLeftOffset+this.timelineWidth+4,0],stroke:"#8c8c8c",strokeWidth:2}),this.timeline.add(this.hoverMark),this.hoverMark.hide()},this._prepareLocator=()=>{const{startIndex:e,endIndex:t}=this.props;if(e>=0&&t>=0){const[n,a]=this._calculateCoordinateFromLogIndex(e),[i,o]=this._calculateCoordinateFromLogIndex(t);this.locator=new Je.a.Rect({x:n,y:a,width:this.timelineWidth,height:o-a,stroke:"#000000",strokeWidth:3,opacity:.5,fill:"#8c8c8c"}),this.timeline.add(this.locator)}},this._initComponents=()=>{const{timelineMarginTop:e,timelineMarginBottom:t,timelineWidth:n,timelineLeftOffset:a,data:i}=this.props;null===this.$container&&this._prepareContainer(),this.stage=new Je.a.Stage({container:"#timeline-container",width:this.$container.offsetWidth,height:this.$container.offsetHeight}),this.timeline=new Je.a.Layer({clearBeforeDraw:!0}),this.stage.add(this.timeline),this.timelineMarginTop=e,this.timelineMarginBottom=t,this.timelineWidth=n,this.timelineLeftOffset=a,this.timelineHeight=this.timeline.getHeight()-this.timelineMarginTop-this.timelineMarginBottom,this._renderOutline(),i&&i.length>0&&(this._renderBeginEndTimeStamp(),this._renderLogLines()),this._prepareHoverMark(),this._prepareLocator(),this._initMouseEvent(),this.stage.draw()},this._renderOutline=()=>{const e=new Je.a.Line({points:[this.timelineLeftOffset,this.timelineMarginTop,this.timelineLeftOffset,this.timelineMarginTop+this.timelineHeight],stroke:"grey",strokeWidth:1}),t=e.clone().move({x:this.timelineWidth,y:0});this.timeline.add(e),this.timeline.add(t)},this._renderBeginEndTimeStamp=()=>{const{data:e}=this.props,t=new Je.a.Text({fontFamily:"serif",fontSize:11,text:E()(e[0].time).format("HH:mm:ss"),x:5,y:5}),n=new Je.a.Text({fontFamily:"serif",fontSize:11,text:E()(e[e.length-1].time).format("HH:mm:ss"),x:5,y:5+this.timelineMarginTop+this.timelineHeight});this.timeline.add(t),this.timeline.add(n)},this._renderLogLines=()=>{const{data:e}=this.props,t=this.timelineHeight/(e.length-1);for(let n=0;n<e.length;n++){const a=new Je.a.Line({points:[this.timelineLeftOffset,t*n+this.timelineMarginTop,this.timelineLeftOffset+this.timelineWidth,t*n+this.timelineMarginTop],strokeWidth:1,stroke:e[n].logType.displayColor});this.timeline.add(a)}},this._initMouseEvent=()=>{document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("click",this.onClick)},this._isInTimeline=(e,t)=>{const n=e>this.timelineLeftOffset&&e<this.timelineLeftOffset+this.timelineWidth,a=t>this.timelineMarginTop&&t<this.timelineMarginTop+this.timelineHeight;return n&&a},this._calculateLogIndexFromCoordinate=(e,t)=>{const{data:n}=this.props,a=this.timelineHeight/(n.length-1),i=t%a;return i<1?parseInt(t/a):i>a-1?parseInt(t/a)+1:null},this._calculateCoordinateFromLogIndex=e=>{const{data:t}=this.props,n=this.timelineHeight/(t.length-1);return[this.timelineLeftOffset,n*e+this.timelineMarginTop]},this.$container=null,this.stage=null,this.timeline=null,this.hoverMark=null,this.locator=null,this.timelineMarginTop=0,this.timelineMarginBottom=0,this.timelineHeight=0,this.timelineWidth=0,this.timelineLeftOffset=0,this.state={showToolTip:!1,toolTipX:0,toolTipY:0,hoveredLog:null}}render(){return i.a.createElement(a.Fragment,null,i.a.createElement("div",{id:"timeline-container",style:{width:"50px",height:"100%",display:"flex"}}),i.a.createElement(et,{hoveredLog:this.state.hoveredLog,showing:this.state.showToolTip,x:this.state.toolTipX,y:this.state.toolTipY}))}componentDidMount(){this._initComponents()}shouldComponentUpdate(e,t,n){const{data:a,startIndex:i,endIndex:o}=this.props;return!Object(N.isEqual)(e.data,a)||i!==e.startIndex||o!==e.endIndex||!Object(N.isEqual)(t,this.state)}componentDidUpdate(e,t,n){const{data:a,startIndex:i,endIndex:o}=this.props;this.$container.clientHeight===this.stage.getHeight()&&Object(N.isEqual)(e.data,a)&&i===e.startIndex&&o===e.endIndex||this._initComponents()}componentWillUnmount(){document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("click",this.onClick)}}class et extends i.a.Component{render(){const{hoveredLog:e,showing:t,x:n,y:a}=this.props;if(!e||!t)return i.a.createElement("div",{style:{visible:!1}});const o={position:"absolute",left:n,top:a,border:"1px solid #8c8c8c",backgroundColor:"white",borderRadius:"5px",padding:"0px 10px",lineHeight:"25px",zIndex:"999"};return i.a.createElement("div",{style:o},"\u65e5\u5fd7ID: ",e.id,i.a.createElement("br",null),"\u65f6\u95f4: ",E()(e.time).format("HH:mm:ss.SSS"),i.a.createElement("br",null),"\u65e5\u5fd7\u7c7b\u578b:",i.a.createElement("span",{style:{color:e.logType.displayColor}},e.logType.logTypeName))}}var tt=Ze;n(495);class nt extends a.Component{constructor(){super(...arguments),this.rollingListManually=e=>{const t=document.querySelector("#infinite-container-inner");if(t){let n=56*e-56;t.scrollTo(0,n)}},this.handleBackToListButtonClicked=()=>{const{type:e,history:t,nativeListFilterConditions:n,webListFilterConditions:a}=this.props;if("native"===e){const{deviceId:e,platform:a,beginTime:i,endTime:o}=n;Object(N.isEmpty)(e)||Object(N.isNil)(e)||Object(N.isNil)(a)||Object(N.isNil)(i)||Object(N.isNil)(o)?t.push("/native-list"):t.push("/native-list?deviceId=".concat(e,"&beginTime=").concat(i,"&endTime=").concat(o,"&platform=").concat(a))}else{const{deviceId:e,beginTime:n,endTime:i}=a;Object(N.isEmpty)(e)||Object(N.isNil)(e)||Object(N.isNil)(n)||Object(N.isNil)(i)?t.push("/web-list"):t.push("/web-list?deviceId=".concat(e,"&beginTime=").concat(n,"&endTime=").concat(i))}},this.handleLogDownloadButtonClicked=()=>{if(this.props.location){const{type:e}=this.props,{tasks:t}=Object(j.parse)(this.props.location.search,{ignoreQueryPrefix:!0});let n=null;n="native"===e?re(t):function(e){return ae.get("/logan/web/getDownLoadUrl.json",{params:{tasks:e}})}(t),n.then(e=>{window.open("".concat(window.location.origin).concat(e))})}},this._calculateUpHasMoreAndDownHasMore=e=>{let{briefs:t,startLogIndex:n}=e,a=!1,i=!1;const o=Math.ceil(t.length/25);if(t.length>0){const e=Math.floor(n/25);0===e?(a=!1,i=!0):e>0&&e<o?(a=!0,i=!0):(a=!0,i=!1)}return{upHasMore:a,downHasMore:i}}}render(){const{briefs:e,taskDetails:t,highlightStartIndex:n,highlightEndIndex:a,logInfo:o,logTypesInTask:s,filterConditions:l,focusLogId:r,logDetail:c,updateFilterConditions:d,updateFocusLogId:p,updateHighLightIndex:h,updateSorted:m,fetchTaskDetail:u,type:g,sorted:T}=this.props,{upHasMore:f,downHasMore:E}=this._calculateUpHasMoreAndDownHasMore({briefs:e,startLogIndex:n});return i.a.createElement("div",{className:"logdetail-container"},i.a.createElement("div",{className:"header"},i.a.createElement(P.a,{icon:"left",onClick:this.handleBackToListButtonClicked},"\u8fd4\u56de\u5217\u8868"),i.a.createElement(Fe,{logInfo:o,type:g}),i.a.createElement(P.a,{icon:"download",onClick:this.handleLogDownloadButtonClicked},"\u65e5\u5fd7\u6587\u4ef6\u4e0b\u8f7d")),i.a.createElement("div",{className:"content"},i.a.createElement(Ne,{type:g,filterConditions:l,logTypesInTask:s,onFilterConditionChanged:d,rollingListManually:this.rollingListManually,onSortedChanged:m,sorted:T}),i.a.createElement("div",{className:"detail-container"},e&&be(e,g).length>50&&i.a.createElement(tt,{type:g,timelineMarginTop:20,timelineMarginBottom:20,timelineWidth:30,timelineLeftOffset:8,data:be(e,g),startIndex:n,endIndex:a,updateFocusLogId:p,updateHighLightIndex:h}),i.a.createElement($e,{type:g,briefs:_e(e,g),upHasMore:f,downHasMore:E,data:t,focusLogId:r,updateHighLightIndex:h,updateFocusLogId:p,fetchTaskDetail:u,rollingListManually:this.rollingListManually}),i.a.createElement(Pe,{type:g,focusLogId:r,logDetail:c,updateFocusLogId:p}))))}}var at=nt;class it extends a.Component{componentDidCatch(e,t){H.a.error("\u9875\u9762\u5f02\u5e38\uff01"),this.props.history.replace("/")}componentDidMount(){const{initState:e}=this.props;e();let t={};this.props.location&&(t=Object(j.parse)(this.props.location.search,{ignoreQueryPrefix:!0}));const{tasks:n,focusLogId:a}=t;this.props.fetchPageInitData(n,a)}render(){return i.a.createElement(at,Object.assign({"data-test":"NativeLogDetailPage"},this.props,{type:"native"}))}}var ot=Object(l.c)((function(e){return Object(T.a)(Object(T.a)({},e.nativeLogDetail),{},{nativeListFilterConditions:e.nativeList.filterConditions})}),(function(e){return{fetchPageInitData:(t,n)=>e(function(e,t){return(n,a)=>Promise.all([ie(e),ae.get("/logan/meta/logtypes.json"),oe(e)]).then(e=>{let[n,a,i]=e;i=Object(N.flattenDeep)(i);let o=[];return i.length>0&&(o=Ee(i,t||i[0].id)),Promise.all([n,a,i,o])}).then(e=>{let[t,n,a,i]=e;return Promise.all([t,n,a,se(i.join(","))])}).then(e=>{let[t,i,o,s]=e;const l=[...new Set(o.map(e=>e.logType))];n({type:"NATIVE_UPDATE_LOG_INFO",logInfo:t}),n({type:"NATIVE_UPDATE_LOG_TYPES",logTypes:i}),n({type:"NATIVE_UPDATE_BRIEFS",briefs:o}),n({type:"NATIVE_UPDATE_LOGDETAIL_FILTER_CONDITIONS",filterConditions:Object(T.a)(Object(T.a)({},a().nativeLogDetail.filterConditions),{},{logTypes:l})}),n({type:"NATIVE_UPDATE_LOG_TYPES_IN_TASK",logTypesInTask:l}),n({type:"NATIVE_UPDATE_TASK_DETAIL",taskDetails:s})})}(t,n)),updateFocusLogId:t=>{return e((n=t,(e,t)=>{if(-1!==n){const a=t(),{briefs:i,taskDetails:o}=a.nativeLogDetail,s=Ee(i,n);return void 0===o.find(e=>e.id===n)?se(s.join(",")).then(t=>{e({type:"NATIVE_UPDATE_TASK_DETAIL",taskDetails:t})}).then(()=>le(n)).then(t=>{e({type:"NATIVE_UPDATE_LOG_DETAIL",logDetail:t})}).then(()=>{e({type:"NATIVE_UPDATE_FOCUS_LOG_ID",focusLogId:n})}):le(n).then(t=>{e({type:"NATIVE_UPDATE_LOG_DETAIL",logDetail:t})}).then(()=>{e({type:"NATIVE_UPDATE_FOCUS_LOG_ID",focusLogId:n})})}e({type:"NATIVE_UPDATE_LOG_DETAIL",logDetail:null}),e({type:"NATIVE_UPDATE_FOCUS_LOG_ID",focusLogId:n})}));var n},updateFilterConditions:t=>e(function(e){return(t,n)=>{t({type:"NATIVE_UPDATE_LOGDETAIL_FILTER_CONDITIONS",filterConditions:e});const{logInfo:a}=n().nativeLogDetail;if(a)return oe(a.taskId,e.logTypes.join(","),e.keyword).then(e=>{const n=Object(N.flattenDeep)(e);return t({type:"NATIVE_UPDATE_BRIEFS",briefs:n}),n}).then(e=>se(e.map(e=>e.id).join(","))).then(e=>{t({type:"NATIVE_UPDATE_TASK_DETAIL",taskDetails:e})})}}(t)),updateHighLightIndex:(t,n)=>e(function(e,t){return n=>{n({type:"NATIVE_UPDATE_HIGH_LIGHT_INDEX",highlightStartIndex:e,highlightEndIndex:t})}}(t,n)),fetchTaskDetail:(t,n)=>e(function(e,t){return n=>se(e.join(",")).then(e=>{n({type:"NATIVE_UPDATE_TASK_DETAIL",taskDetails:e,direction:t})})}(t,n)),initState:()=>e(e=>{e({type:"NATIVE_INITIAL_STATE"})}),updateSorted:t=>e(function(e){return(t,n)=>{t({type:"NATIVE_UPDATE_SORTED",sorted:e});const{logInfo:a,filterConditions:i}=n().nativeLogDetail;if(a)return oe(a.taskId,i.logTypes.join(","),i.keyword).then(t=>{const n=Object(N.flattenDeep)(t);let a=[];e?a=Object(N.sortBy)(n,e=>e.id):(a=Object(N.sortBy)(n,e=>e.id),a=Object(N.reverse)(a));const i=Ee(_e(a,"native"),a[0].id);return Promise.all([i,a])}).then(e=>{let[t,n]=e;return Promise.all([n,se(t.join(","))])}).then(e=>{let[n,a]=e;t({type:"NATIVE_UPDATE_BRIEFS",briefs:n}),t({type:"NATIVE_UPDATE_HIGH_LIGHT_INDEX",highlightStartIndex:-1,highlightEndIndex:-1}),t({type:"NATIVE_UPDATE_FOCUS_LOG_ID",focusLogId:-1}),t({type:"NATIVE_UPDATE_TASK_DETAIL",taskDetails:a})})}}(t))}}))(it);function st(){return e=>ae.get("/logan/web/latest.json").then(t=>{e({type:"WEB_UPDATE_TASKS",tasks:t})})}function lt(e){let{deviceId:t,beginTime:n,endTime:a}=e;return e=>function(e,t,n){return ae.get("/logan/web/search.json",{params:{deviceId:e,beginTime:t,endTime:n}})}(t,n,a).then(t=>{e({type:"WEB_UPDATE_TASKS",tasks:t})})}class rt extends a.Component{componentDidCatch(e,t){H.a.error("\u9875\u9762\u5f02\u5e38\uff01"),this.props.history.replace("/")}componentDidMount(){const{updateFilterConditions:e,fetchTasks:t,fetchInitData:n}=this.props;let a={};this.props.location&&(a=Object(j.parse)(this.props.location.search,{ignoreQueryPrefix:!0}));const{deviceId:i,beginTime:o,endTime:s}=a;Object(N.some)([i,o,s],e=>void 0===e)&&!Object(N.every)([i,o,s],e=>void 0===e)&&H.a.warn("url\u53c2\u6570\u9519\u8bef\uff01\u83b7\u53d6\u9ed8\u8ba4\u65e5\u5fd7\u5217\u8868"),e({deviceId:i||"",beginTime:o?E()(Number.parseInt(o)).valueOf():E()().startOf("day").subtract(6,"days").valueOf(),endTime:s?E()(Number.parseInt(s)).valueOf():E()().startOf("day").valueOf()}),i&&o&&s?t({deviceId:i,beginTime:E()(Number.parseInt(o)).valueOf(),endTime:E()(Number.parseInt(s)).valueOf()}):n()}render(){return i.a.createElement(Z,Object.assign({},this.props,{"data-test":"ListPage",type:"web",detailUrlPrefix:"/web-detail"}))}}var ct=Object(l.c)((function(e){return Object(T.a)({},e.webList)}),(function(e){return{updateFilterConditions:t=>e(function(e){return t=>{t({type:"WEB_UPDATE_FILTER_CONDITIONS",filterConditions:e})}}(t)),fetchTasks:t=>e(lt(t)),fetchInitData:()=>e(st())}}))(rt);class dt extends a.Component{componentDidCatch(e,t){H.a.error("\u9875\u9762\u5f02\u5e38\uff01"),this.props.history.replace("/")}componentDidMount(){const{initState:e}=this.props;e();let t={};this.props.location&&(t=Object(j.parse)(this.props.location.search,{ignoreQueryPrefix:!0}));const{tasks:n,focusLogId:a}=t;this.props.fetchPageInitData(n,a)}render(){return i.a.createElement(at,Object.assign({"data-test":"WebLogDetailPage"},this.props,{type:"web"}))}}var pt=Object(l.c)((function(e){return Object(T.a)(Object(T.a)({},e.webLogDetail),{},{webListFilterConditions:e.webList.filterConditions})}),(function(e){return{fetchPageInitData:(t,n)=>e(function(e,t){return(n,a)=>Promise.all([pe(e),ce(e)]).then(e=>{let[n,a]=e;a=Object(N.flattenDeep)(a);const i=a.map(e=>({id:e.detailId,logType:e.logType,logTime:e.logTime}));let o=[];return i.length>0&&(o=Ee(i,t||i[0].id)),Promise.all([n,a,o])}).then(e=>{let[t,n,a]=e;return Promise.all([t,n,de(a.join(","))])}).then(e=>{let[t,i,o]=e;const s=[...new Set(i.map(e=>e.logType))];n({type:"WEB_UPDATE_LOG_INFO",logInfo:t}),n({type:"WEB_UPDATE_BRIEFS",briefs:i}),n({type:"WEB_UPDATE_LOGDETAIL_FILTER_CONDITIONS",filterConditions:Object(T.a)(Object(T.a)({},a().webLogDetail.filterConditions),{},{logTypes:s})}),n({type:"WEB_UPDATE_LOG_TYPES_IN_TASK",logTypesInTask:s}),n({type:"WEB_UPDATE_TASK_DETAIL",taskDetails:o})})}(t,n)),updateFocusLogId:t=>{return e((n=t,console.log("focusLogId: ".concat(n)),(e,t)=>{if(-1===n)return e({type:"WEB_UPDATE_LOG_DETAIL",logDetail:null}),void e({type:"WEB_UPDATE_FOCUS_LOG_ID",focusLogId:n});const a=t(),{briefs:i,taskDetails:o}=a.webLogDetail,s=Ee(_e(i,"web"),n);return void 0===o.find(e=>e.id===n)?de(s.join(",")).then(t=>{e({type:"WEB_UPDATE_TASK_DETAIL",taskDetails:t})}).then(()=>he(n)).then(t=>{e({type:"WEB_UPDATE_LOG_DETAIL",logDetail:t})}).then(()=>{e({type:"WEB_UPDATE_FOCUS_LOG_ID",focusLogId:n})}):he(n).then(t=>{e({type:"WEB_UPDATE_LOG_DETAIL",logDetail:t})}).then(()=>{e({type:"WEB_UPDATE_FOCUS_LOG_ID",focusLogId:n})})}));var n},updateFilterConditions:t=>e(function(e){return(t,n)=>{t({type:"WEB_UPDATE_LOGDETAIL_FILTER_CONDITIONS",filterConditions:e});const{logInfo:a}=n().webLogDetail;if(a)return ce(a.taskId,e.logTypes.join(","),e.keyword).then(e=>{let n=Object(N.flattenDeep)(e);return t({type:"WEB_UPDATE_BRIEFS",briefs:n}),n}).then(e=>de(e.map(e=>e.detailId).join(","))).then(e=>{t({type:"WEB_UPDATE_TASK_DETAIL",taskDetails:e})})}}(t)),updateHighLightIndex:(t,n)=>e(function(e,t){return n=>{n({type:"WEB_UPDATE_HIGH_LIGHT_INDEX",highlightStartIndex:e,highlightEndIndex:t})}}(t,n)),fetchTaskDetail:(t,n)=>e(function(e,t){return n=>de(e.join(",")).then(e=>{n({type:"WEB_UPDATE_TASK_DETAIL",taskDetails:e,direction:t})})}(t,n)),updateSorted:t=>e(function(e){return(t,n)=>{t({type:"WEB_UPDATE_SORTED",sorted:e});const{logInfo:a,filterConditions:i}=n().webLogDetail;if(a)return ce(a.taskId,i.logTypes.join(","),i.keyword).then(t=>{const n=Object(N.flattenDeep)(t);let a=[];e?a=Object(N.sortBy)(n,e=>e.detailId):(a=Object(N.sortBy)(n,e=>e.detailId),a=Object(N.reverse)(a));const i=Ee(_e(a,"web"),a[0].detailId);return Promise.all([i,a])}).then(e=>{let[t,n]=e;return Promise.all([n,de(t.join(","))])}).then(e=>{let[n,a]=e;t({type:"WEB_UPDATE_BRIEFS",briefs:n}),t({type:"WEB_UPDATE_HIGH_LIGHT_INDEX",highlightStartIndex:-1,highlightEndIndex:-1}),t({type:"WEB_UPDATE_FOCUS_LOG_ID",focusLogId:-1}),t({type:"WEB_UPDATE_TASK_DETAIL",taskDetails:a})})}}(t)),initState:()=>e(e=>{e({type:"WEB_INITIAL_STATE"})})}}))(dt),ht=n(159),mt=n(235),ut=n.n(mt);n(496);class gt extends a.Component{constructor(){super(...arguments),this.state={selectedKeys:["0"]},this.handleMenuClick=e=>{let{key:t}=e;"0"===t?(window.location.hash="#/native-list",this.setState({selectedKeys:["0"]})):"1"===t?(window.location.hash="#/web-list",this.setState({selectedKeys:["1"]})):(window.location.hash="#/native-list",this.setState({selectedKeys:["0"]}))}}render(){return i.a.createElement(d.a.Sider,{style:Tt.sider,trigger:null},i.a.createElement("div",null,i.a.createElement("div",{className:"sider-logo",style:Tt.logo}),i.a.createElement(ht.a,{theme:"dark",mode:"inline",defaultSelectedKeys:["0"],selectedKeys:this.state.selectedKeys,onClick:this.handleMenuClick},i.a.createElement(ht.a.Item,{key:"0"},i.a.createElement(x.a,{type:"mobile"}),i.a.createElement("span",null,"Native\u65e5\u5fd7")),i.a.createElement(ht.a.Item,{key:"1"},i.a.createElement(x.a,{type:"html5"}),i.a.createElement("span",null,"Web\u65e5\u5fd7")))))}componentDidMount(){const{pathname:e}=this.props;"/native-list"===e||"/native-log-detail"===e?this.setState({selectedKeys:["0"]}):"/web-list"===e||"/web-detail"===e?this.setState({selectedKeys:["1"]}):this.setState({selectedKeys:["0"]})}shouldComponentUpdate(e,t,n){return!Object(N.isEqual)(t,this.state)||!Object(N.isEqual)(e,this.props)}componentDidUpdate(e,t,n){const{pathname:a}=this.props;"/native-list"===a||"/native-log-detail"===a?this.setState({selectedKeys:["0"]}):"/web-list"===a||"/web-detail"===a?this.setState({selectedKeys:["1"]}):this.setState({selectedKeys:["0"]})}}const Tt={sider:{height:"100%"},logo:{backgroundImage:ut.a,backgroundRepeat:"no-repeat",backgroundSize:"cover",color:"#ffffff",textAlign:"center",lineHeight:"32px",height:"80px",margin:"5px",cursor:"pointer"}};var ft=Object(l.c)((function(e){return{pathname:e.router.location.pathname,search:e.router.location.search,hash:e.router.location.hash}}))(gt);n(497);class Et extends a.Component{componentDidCatch(e,t){console.log(e)}render(){return i.a.createElement(c.a,{history:k},i.a.createElement(i.a.Fragment,null,i.a.createElement(d.a,{style:{height:"100%"}},i.a.createElement(ft,null),i.a.createElement("div",{className:"app"},i.a.createElement(r.d,null,i.a.createElement(r.a,{exact:!0,from:"/",to:"/native-list"}),i.a.createElement(r.b,{exact:!0,path:"/native-list",component:fe}),i.a.createElement(r.b,{exact:!0,path:"/native-log-detail",component:ot}),i.a.createElement(r.b,{exact:!0,path:"/web-list",component:ct}),i.a.createElement(r.b,{exact:!0,path:"/web-detail",component:pt}))))))}}var It=Et;s.a.render(i.a.createElement(l.a,{store:A},i.a.createElement(It,null)),document.getElementById("root"))}},[[240,1,2]]]);
//# sourceMappingURL=main.022f7343.chunk.js.map